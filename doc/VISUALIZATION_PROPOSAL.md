# 発話統計可視化の検討案

## 目的の再確認

1. **ホストがファシリテートしやすくなること**

   - 誰が多く話しているか、少なく話しているかを一目で把握
   - 発話のバランスが取れているかを判断
   - 介入が必要なタイミングを把握

2. **参加者たちが自分で発言のバランスを取ろうとすること**
   - 自分の発話状況を客観的に把握
   - 他の参加者との比較
   - 発話の偏りに気づく

---

## 現在実装されている指標

- ✅ **発話回数** (`speakingCount`)
- ✅ **総発話時間** (`totalSpeakingMs`)
- ✅ **現在話しているかどうか** (`isSpeaking`)

---

## 追加検討すべき指標

### 1. 基本統計指標

#### 1-1. 1 回あたりの平均発話時間 ⭐（ユーザー提案）

**計算式**: `総発話時間 / 発話回数`

**表示例**: `平均 00:15` または `15秒/回`

**目的**:

- 長めの発話が多いか、短めの発話が多いかを把握
- ホスト: 長く話し続けている人を特定
- 参加者: 自分の発話スタイルを認識

**実装のしやすさ**: ⭐⭐⭐⭐⭐（既存データから計算可能）

---

#### 1-2. 発話シェア（全体に占める割合）

**計算式**: `(個人の総発話時間 / 全員の総発話時間) × 100`

**表示例**: `25%` または プログレスバー

**目的**:

- 発話の偏りを視覚的に把握
- ホスト: 特定の人が支配的になっていないか確認
- 参加者: 自分の発話量が適切かを判断

**実装のしやすさ**: ⭐⭐⭐⭐⭐（既存データから計算可能）

---

#### 1-3. 発話頻度（時間あたりの発話回数）

**計算式**: `発話回数 / ミーティング経過時間（分）`

**表示例**: `2.5回/分` または `頻度: 中`

**目的**:

- 発話の頻度パターンを把握
- ホスト: 頻繁に話す人と、少ないが長く話す人を区別
- 参加者: 自分の発話パターンを認識

**実装のしやすさ**: ⭐⭐⭐⭐（ミーティング開始時刻の記録が必要）

---

### 2. バランス指標

#### 2-1. 発話バランススコア

**計算式**:

- 理想的な発話時間 = 総発話時間 / 参加者数
- 偏差 = |個人の発話時間 - 理想的な発話時間| / 理想的な発話時間
- スコア = 100 - (偏差 × 100) （0-100 の範囲）

**表示例**:

- スコア: `85/100` または `バランス: 良好`
- カラーコード: 🟢 良好 / 🟡 普通 / 🔴 偏り

**目的**:

- 発話のバランスを数値化
- ホスト: 全体のバランスを一目で把握
- 参加者: 自分の発話が適切かを数値で確認

**実装のしやすさ**: ⭐⭐⭐⭐⭐（既存データから計算可能）

---

#### 2-2. 発話の分散度（標準偏差）

**計算式**: 全参加者の発話時間の標準偏差

**表示例**: `分散度: 低` または `バランス: 良好`

**目的**:

- 全体の発話のばらつきを把握
- ホスト: ミーティング全体のバランス状況を判断

**実装のしやすさ**: ⭐⭐⭐⭐⭐（既存データから計算可能）

---

### 3. 時間軸に関する指標

#### 3-1. 最後に話してからの経過時間

**計算式**: `現在時刻 - 最後の発話終了時刻`

**表示例**: `5分前` または `未発言: 10分`

**目的**:

- 長く発言していない人を特定
- ホスト: 発言機会を促すべき人を把握
- 参加者: 自分の発言が少ないことに気づく

**実装のしやすさ**: ⭐⭐⭐⭐（最後の発話終了時刻の記録が必要）

---

#### 3-2. 発話のタイミング分布（前半/後半）

**計算式**:

- ミーティング時間を前半/後半に分割
- 各期間での発話時間を記録

**表示例**:

- `前半: 5分 / 後半: 2分`
- または グラフ表示

**目的**:

- 発話のタイミングパターンを把握
- ホスト: 後半に発言が少ない人を特定
- 参加者: 自分の発話タイミングを認識

**実装のしやすさ**: ⭐⭐⭐（発話履歴の記録が必要）

---

### 4. 発話パターン指標

#### 4-1. 最長発話時間

**計算式**: 各発話セッションの最大値

**表示例**: `最長: 3分15秒`

**目的**:

- 長く話し続けた記録を把握
- ホスト: 長時間話し続ける傾向がある人を特定
- 参加者: 自分の発話スタイルを認識

**実装のしやすさ**: ⭐⭐⭐（各発話セッションの記録が必要）

---

#### 4-2. 最短発話時間

**計算式**: 各発話セッションの最小値

**表示例**: `最短: 5秒`

**目的**:

- 短い発話が多いかどうかを把握
- ホスト: 短い発話が多い人（相槌など）を特定

**実装のしやすさ**: ⭐⭐⭐（各発話セッションの記録が必要）

---

#### 4-3. 発話の一貫性（標準偏差）

**計算式**: 各発話セッションの時間の標準偏差

**表示例**: `一貫性: 高` または `ばらつき: 小`

**目的**:

- 発話時間のばらつきを把握
- ホスト: 発話パターンが一定かどうかを判断

**実装のしやすさ**: ⭐⭐⭐（各発話セッションの記録が必要）

---

### 5. 視覚的表現

#### 5-1. 発話時間のプログレスバー

**表示例**: 各参加者の発話時間を視覚的に表示

**目的**:

- 発話量を直感的に把握
- ホスト: 一目でバランスを確認
- 参加者: 自分の発話量を視覚的に認識

**実装のしやすさ**: ⭐⭐⭐⭐⭐

---

#### 5-2. 発話シェアの円グラフ

**表示例**: 全体の発話時間を円グラフで表示

**目的**:

- 発話の偏りを視覚的に把握
- ホスト: 全体のバランスを一目で確認

**実装のしやすさ**: ⭐⭐⭐⭐

---

#### 5-3. 発話のタイムライン

**表示例**: 時間軸に沿って発話を可視化

**目的**:

- 発話のタイミングパターンを把握
- ホスト: 発話の集中や空白を確認

**実装のしやすさ**: ⭐⭐⭐（発話履歴の記録が必要）

---

#### 5-4. カラーコードによる状態表示

**表示例**:

- 🟢 発話バランス良好
- 🟡 発話がやや少ない/多い
- 🔴 発話が極端に少ない/多い

**目的**:

- 状態を一目で把握
- ホスト: 介入が必要な人を特定
- 参加者: 自分の状態を認識

**実装のしやすさ**: ⭐⭐⭐⭐⭐

---

## 優先度の検討

### 高優先度（実装しやすく、効果が高い）

1. **1 回あたりの平均発話時間** ⭐⭐⭐⭐⭐

   - 既存データから計算可能
   - 発話スタイルを把握できる
   - 実装が簡単

2. **発話シェア（全体に占める割合）** ⭐⭐⭐⭐⭐

   - 既存データから計算可能
   - バランスを視覚的に把握できる
   - 実装が簡単

3. **発話バランススコア** ⭐⭐⭐⭐⭐

   - 既存データから計算可能
   - 数値化により判断しやすい
   - 実装が簡単

4. **プログレスバー表示** ⭐⭐⭐⭐⭐

   - 視覚的に分かりやすい
   - 実装が簡単

5. **カラーコード表示** ⭐⭐⭐⭐⭐
   - 状態を一目で把握できる
   - 実装が簡単

---

### 中優先度（追加のデータ記録が必要だが効果が高い）

6. **最後に話してからの経過時間** ⭐⭐⭐⭐

   - 発言機会を促すのに有効
   - 最後の発話終了時刻の記録が必要

7. **発話頻度（時間あたりの発話回数）** ⭐⭐⭐⭐
   - 発話パターンを把握できる
   - ミーティング開始時刻の記録が必要

---

### 低優先度（実装が複雑だが有用）

8. **発話のタイミング分布** ⭐⭐⭐

   - 発話履歴の記録が必要
   - 実装がやや複雑

9. **最長/最短発話時間** ⭐⭐⭐

   - 各発話セッションの記録が必要
   - 実装がやや複雑

10. **発話のタイムライン** ⭐⭐⭐
    - 発話履歴の記録が必要
    - 実装がやや複雑

---

## 推奨実装順序

### Phase 1: 基本指標の追加（既存データで計算可能）

1. 1 回あたりの平均発話時間
2. 発話シェア（全体に占める割合）
3. 発話バランススコア
4. プログレスバー表示
5. カラーコード表示

### Phase 2: 時間軸指標の追加（追加データ記録が必要）

6. 最後に話してからの経過時間
7. 発話頻度（時間あたりの発話回数）

### Phase 3: 高度な可視化（発話履歴の記録が必要）

8. 発話のタイミング分布
9. 最長/最短発話時間
10. 発話のタイムライン

---

## データモデルの拡張案

現在の `ParticipantStats` に追加が必要な項目：

```typescript
export interface ParticipantStats {
  // 既存
  participantId: string;
  displayName: string;
  speakingCount: number;
  totalSpeakingMs: number;
  isSpeaking: boolean;
  lastStartedSpeakingAt: number | null;

  // 追加検討項目
  lastStoppedSpeakingAt?: number | null; // 最後に話し終えた時刻
  meetingStartTime?: number; // ミーティング開始時刻
  speakingSessions?: Array<{
    // 各発話セッションの記録
    startTime: number;
    endTime: number;
    duration: number;
  }>;
}
```

---

## UI/UX の検討

### テーブル表示の拡張

現在のテーブルに以下の列を追加：

| 表示名   | 発話回数 | 総発話時間 | 平均発話時間 | 発話シェア | バランススコア | 状態 |
| -------- | -------- | ---------- | ------------ | ---------- | -------------- | ---- |
| 山田太郎 | 15       | 05:30      | 00:22        | 25%        | 85/100         | 🟢   |

### 視覚的表現

- **プログレスバー**: 各参加者の発話時間を視覚化
- **カラーコード**: バランススコアに応じた色分け
- **アイコン**: 状態を示すアイコン（🟢🟡🔴）

### ダッシュボードの拡張

- **全体統計セクション**: 全体の発話バランスを表示
- **アラートセクション**: バランスが偏っている場合の警告
- **グラフセクション**: 発話シェアの円グラフなど

---

## まとめ

### 即座に実装できる指標（Phase 1）

1. ✅ 1 回あたりの平均発話時間
2. ✅ 発話シェア（全体に占める割合）
3. ✅ 発話バランススコア
4. ✅ プログレスバー表示
5. ✅ カラーコード表示

これらの指標は、既存のデータ（`speakingCount` と `totalSpeakingMs`）から計算可能で、実装が簡単でありながら、ホストのファシリテーションと参加者の自己調整の両方に有効です。

### 追加データ記録が必要な指標（Phase 2）

6. 最後に話してからの経過時間
7. 発話頻度（時間あたりの発話回数）

これらの指標は、追加のデータ記録（最後の発話終了時刻、ミーティング開始時刻）が必要ですが、ファシリテーションに非常に有効です。
